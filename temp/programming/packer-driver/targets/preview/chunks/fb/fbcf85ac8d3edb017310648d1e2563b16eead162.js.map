{"version":3,"sources":["file:///D:/Cocos/work/CocosSolitaireCreative/assets/scripts/ui/ScreenScaler.ts"],"names":["_decorator","Component","Node","screen","view","ResolutionPolicy","Widget","Letter","ccclass","property","ScreenScaler","type","originalWidth","originalHeigth","originalRatio","horizontalState","originalLetterContainerPosition","originalCardContainerPosition","originalCompletedWordsContainerPosition","originalWordsContainerPosition","originalHandPosition","originalPlayWidgetRight","originalLetterContainerScale","start","letterContainer","getPosition","cardContainer","completedWordsContainer","wordsContainer","hand","getScale","clone","playWidget","getComponent","right","onWindowResize","windowSize","width","height","onLoad","on","onDestroy","off","currentHorizontalState","ratio","scale","massLetter","getComponentsInChildren","mass","forEach","letter","getCard","push","setDesignResolutionSize","FIXED_WIDTH","setPosition","x","y","getParent","length","card","node","FIXED_HEIGHT","setScale","win","constName","sentences","background","console","log"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, screen, Vec2, Vec3, view, ResolutionPolicy, Widget, Canvas } from 'cc';\r\nimport { Letter } from '../solitaire/Letter';\r\nimport Card from '../solitaire/Card';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('ScreenScaler')\r\nexport class ScreenScaler extends Component {\r\n\r\n    @property({type: Node})\r\n    private letterContainer: Node = null;\r\n\r\n    @property({type: Node})\r\n    private cardContainer: Node = null;\r\n    \r\n    @property({type: Node})\r\n    private completedWordsContainer: Node = null;\r\n\r\n    @property(Node)\r\n    private wordsContainer: Node = null;\r\n\r\n    @property({type: Node})\r\n    private playWidget: Node = null;\r\n\r\n    @property({type: Node})\r\n    private iconWidget: Node = null;\r\n\r\n    @property(Node)\r\n    private hand: Node = null;\r\n\r\n    @property({type: Node})\r\n    private background: Node = null;\r\n    @property({type: Node})\r\n    private constName: Node = null;\r\n    @property({type: Node})\r\n    private sentences: Node = null;\r\n\r\n    @property({type: Node})\r\n    private win: Node = null;\r\n\r\n\r\n\r\n    private originalWidth: number = 1920;\r\n    private originalHeigth: number = 1080;\r\n    \r\n\r\n    private originalRatio: number = this.originalHeigth / this.originalWidth;\r\n    private horizontalState: boolean = true;\r\n\r\n    private originalLetterContainerPosition: Vec3;\r\n    private originalCardContainerPosition: Vec3;\r\n    private originalCompletedWordsContainerPosition: Vec3;\r\n    private originalWordsContainerPosition: Vec3;\r\n    private originalHandPosition: Vec3;\r\n\r\n    private originalPlayWidgetRight: number;\r\n\r\n    private originalLetterContainerScale: Vec3;\r\n\r\n\r\n    start() {\r\n        this.originalLetterContainerPosition = this.letterContainer.getPosition();\r\n        this.originalCardContainerPosition = this.cardContainer.getPosition();\r\n        this.originalCompletedWordsContainerPosition = this.completedWordsContainer.getPosition();\r\n        this.originalWordsContainerPosition = this.wordsContainer.getPosition();\r\n        this.originalHandPosition = this.hand.getPosition();\r\n\r\n\r\n        this.originalLetterContainerScale = this.letterContainer.getScale().clone();\r\n\r\n        this.originalPlayWidgetRight =  this.playWidget.getComponent(Widget).right;\r\n        \r\n        this.onWindowResize(screen.windowSize.width, screen.windowSize.height);\r\n    }\r\n\r\n    onLoad() {\r\n        screen.on('window-resize', this.onWindowResize, this);\r\n    }\r\n    \r\n    onDestroy() {\r\n        screen.off('window-resize', this.onWindowResize, this);\r\n    }\r\n\r\n    onWindowResize(width: number, height: number) {\r\n        \r\n        const currentHorizontalState = width >= height;\r\n\r\n        const ratio = currentHorizontalState ? height / width : width / height;\r\n        let scale = ratio / this.originalRatio;\r\n        if (scale > 1) scale = 1;\r\n\r\n\r\n        if (currentHorizontalState != this.horizontalState) {\r\n\r\n            this.horizontalState = currentHorizontalState;\r\n            let massLetter: Letter[] = this.letterContainer.getComponentsInChildren(Letter);\r\n            let mass: Card[] = [];\r\n            massLetter.forEach(letter => {\r\n                if(letter.getCard()){\r\n                    mass.push(letter.getCard());\r\n                }\r\n            });\r\n            if (currentHorizontalState) {\r\n                view.setDesignResolutionSize(this.originalWidth, this.originalHeigth, ResolutionPolicy.FIXED_WIDTH);\r\n\r\n                this.letterContainer.setPosition(\r\n                    this.originalLetterContainerPosition.x * scale,\r\n                    this.originalLetterContainerPosition.y  * scale\r\n                );\r\n                this.cardContainer.setPosition(\r\n                    this.originalCardContainerPosition.x * scale,\r\n                    this.originalCardContainerPosition.y  * scale\r\n                );\r\n                this.completedWordsContainer.setPosition(\r\n                    this.originalCompletedWordsContainerPosition.x * scale,\r\n                    this.originalCompletedWordsContainerPosition.y * scale\r\n                );\r\n                this.wordsContainer.setPosition(\r\n                    this.originalWordsContainerPosition.x * scale,\r\n                    this.originalWordsContainerPosition.y * scale\r\n                );\r\n                this.originalHandPosition = this.hand.getParent().getPosition();\r\n                this.hand.getParent().setPosition(\r\n                    this.originalHandPosition.x * scale / 1.6,\r\n                    this.originalHandPosition.y * scale / 1.2\r\n                );\r\n                if(mass.length > 0){\r\n                mass.forEach(card => {\r\n                    card.node.setPosition(card.node.getPosition().x * scale, card.node.getPosition().y * scale / 1.025);\r\n                });\r\n            }\r\n                this.playWidget.getComponent(Widget).right = this.originalPlayWidgetRight;\r\n            }\r\n            else {\r\n                view.setDesignResolutionSize(this.originalHeigth, this.originalWidth, ResolutionPolicy.FIXED_HEIGHT);\r\n                this.letterContainer.setPosition(\r\n                    this.originalLetterContainerPosition.x * scale * 1.4,\r\n                    this.originalLetterContainerPosition.y  * scale* 1.4\r\n                );\r\n                this.cardContainer.setPosition(\r\n                    this.originalCardContainerPosition.x * scale* 1.7,\r\n                    this.originalCardContainerPosition.y  * scale / 1.7\r\n                );\r\n                this.completedWordsContainer.setPosition(\r\n                    this.originalCompletedWordsContainerPosition.x * scale * 1.5,\r\n                    this.originalCompletedWordsContainerPosition.y * scale* 2.2\r\n                );\r\n                this.wordsContainer.setPosition(\r\n                    this.originalWordsContainerPosition.x * scale * 3.1,\r\n                    this.originalWordsContainerPosition.y * scale * 3.1\r\n                );\r\n                this.originalHandPosition = this.hand.getParent().getPosition();\r\n                this.hand.getParent().setPosition(\r\n                    this.originalHandPosition.x * scale * 1.6,\r\n                    this.originalHandPosition.y * scale * 1.2\r\n                );\r\n                if(mass.length > 0){\r\n                    mass.forEach(card => {\r\n                        card.node.setPosition(card.node.getPosition().x * scale, card.node.getPosition().y * scale * 1.025);\r\n                    });\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        \r\n\r\n        this.letterContainer.setScale(this.originalLetterContainerScale.x * scale, this.originalLetterContainerScale.y * scale);\r\n        this.cardContainer.setScale(scale, scale);\r\n        this.completedWordsContainer.setScale(scale * 1.3, scale * 1.3);\r\n        this.playWidget.setScale(scale, scale);\r\n        this.win.setScale(scale, scale);\r\n        this.constName.setScale(scale, scale);\r\n        this.sentences.setScale(scale, scale);\r\n        this.background.setScale(scale, scale);\r\n        this.wordsContainer.setScale(scale, scale);\r\n        this.hand.setScale(scale, scale);\r\n\r\n        if (!currentHorizontalState) {\r\n\r\n            this.background.setScale(scale * 2, scale * 2);\r\n            this.letterContainer.setScale(this.originalLetterContainerScale.x * 1.7 * scale, this.originalLetterContainerScale.y * 1.7* scale);\r\n            this.cardContainer.setScale(scale * 1.7, scale * 1.7);\r\n            this.completedWordsContainer.setScale(scale * 2, scale * 2);\r\n            this.sentences.setScale(scale * 1.4, scale * 1.4);\r\n            this.wordsContainer.setScale(scale * 1.6, scale * 1.6);\r\n            this.hand.setScale(scale * 1.4, scale * 1.4);\r\n\r\n        }\r\n\r\n        \r\n       \r\n        console.log(`Screen resized: width=${width}, height=${height}, scale=${scale}`);\r\n    }\r\n    \r\n    \r\n    \r\n}\r\n\r\n\r\n\r\n\r\n"]}