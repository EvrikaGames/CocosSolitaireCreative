{"version":3,"sources":["file:///D:/Cocos/work/CocosSolitaireCreative/assets/scripts/ui/ScreenScaler.ts"],"names":["_decorator","Component","Node","screen","view","ResolutionPolicy","Widget","ccclass","property","ScreenScaler","type","originalWidth","originalHeigth","originalRatio","horizontalState","originalLetterContainerPosition","originalCardContainerPosition","originalCompletedWordsContainerPosition","originalPlayWidgetRight","originalLetterContainerScale","start","letterContainer","getPosition","cardContainer","completedWordsContainer","getScale","clone","playWidget","getComponent","right","onWindowResize","windowSize","width","height","onLoad","on","onDestroy","off","currentHorizontalState","ratio","scale","setDesignResolutionSize","FIXED_WIDTH","setPosition","x","y","FIXED_HEIGHT","setScale","win","constName","sentences","background","console","log"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, screen, Vec2, Vec3, view, ResolutionPolicy, Widget, Canvas } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('ScreenScaler')\r\nexport class ScreenScaler extends Component {\r\n\r\n    @property({type: Node})\r\n    private letterContainer: Node = null;\r\n\r\n    @property({type: Node})\r\n    private cardContainer: Node = null;\r\n    \r\n    @property({type: Node})\r\n    private completedWordsContainer: Node = null;\r\n\r\n    @property({type: Node})\r\n    private playWidget: Node = null;\r\n\r\n    @property({type: Node})\r\n    private iconWidget: Node = null;\r\n\r\n    @property({type: Node})\r\n    private background: Node = null;\r\n    @property({type: Node})\r\n    private constName: Node = null;\r\n    @property({type: Node})\r\n    private sentences: Node = null;\r\n\r\n    @property({type: Node})\r\n    private win: Node = null;\r\n\r\n    private originalWidth: number = 1920;\r\n    private originalHeigth: number = 1080;\r\n    \r\n\r\n    private originalRatio: number = this.originalHeigth / this.originalWidth;\r\n    private horizontalState: boolean = true;\r\n\r\n    private originalLetterContainerPosition: Vec3;\r\n    private originalCardContainerPosition: Vec3;\r\n    private originalCompletedWordsContainerPosition: Vec3;\r\n\r\n\r\n    private originalPlayWidgetRight: number;\r\n\r\n    private originalLetterContainerScale: Vec3;\r\n\r\n\r\n    start() {\r\n        this.originalLetterContainerPosition = this.letterContainer.getPosition();\r\n        this.originalCardContainerPosition = this.cardContainer.getPosition();\r\n        this.originalCompletedWordsContainerPosition = this.completedWordsContainer.getPosition();\r\n\r\n\r\n        this.originalLetterContainerScale = this.letterContainer.getScale().clone();\r\n\r\n        this.originalPlayWidgetRight =  this.playWidget.getComponent(Widget).right;\r\n        \r\n        this.onWindowResize(screen.windowSize.width, screen.windowSize.height);\r\n    }\r\n\r\n    onLoad() {\r\n        screen.on('window-resize', this.onWindowResize, this);\r\n    }\r\n    \r\n    onDestroy() {\r\n        screen.off('window-resize', this.onWindowResize, this);\r\n    }\r\n\r\n    onWindowResize(width: number, height: number) {\r\n        \r\n        const currentHorizontalState = width >= height;\r\n\r\n        const ratio = currentHorizontalState ? height / width : width / height;\r\n        let scale = ratio / this.originalRatio;\r\n        if (scale > 1) scale = 1;\r\n\r\n\r\n        if (currentHorizontalState != this.horizontalState) {\r\n\r\n            this.horizontalState = currentHorizontalState;\r\n\r\n            if (currentHorizontalState) {\r\n                view.setDesignResolutionSize(this.originalWidth, this.originalHeigth, ResolutionPolicy.FIXED_WIDTH);\r\n\r\n                this.letterContainer.setPosition(\r\n                    this.originalLetterContainerPosition.x * scale,\r\n                    this.originalLetterContainerPosition.y  * scale\r\n                );\r\n                this.cardContainer.setPosition(\r\n                    this.originalCardContainerPosition.x * scale,\r\n                    this.originalCardContainerPosition.y  * scale\r\n                );\r\n                this.completedWordsContainer.setPosition(\r\n                    this.originalCompletedWordsContainerPosition.x * scale,\r\n                    this.originalCompletedWordsContainerPosition.y * scale\r\n                );\r\n\r\n                this.playWidget.getComponent(Widget).right = this.originalPlayWidgetRight;\r\n            }\r\n            else {\r\n                view.setDesignResolutionSize(this.originalHeigth, this.originalWidth, ResolutionPolicy.FIXED_HEIGHT);\r\n                this.letterContainer.setPosition(\r\n                    this.originalLetterContainerPosition.x * scale * 1.4,\r\n                    this.originalLetterContainerPosition.y  * scale* 1.4\r\n                );\r\n                this.cardContainer.setPosition(\r\n                    this.originalCardContainerPosition.x * scale* 1.5,\r\n                    this.originalCardContainerPosition.y  * scale* 1\r\n                );\r\n                this.completedWordsContainer.setPosition(\r\n                    this.originalCompletedWordsContainerPosition.x * scale* 2,\r\n                    this.originalCompletedWordsContainerPosition.y * scale* 2.2\r\n                );\r\n\r\n            }\r\n        }\r\n\r\n      \r\n        \r\n\r\n        this.letterContainer.setScale(this.originalLetterContainerScale.x * scale, this.originalLetterContainerScale.y * scale);\r\n        this.cardContainer.setScale(scale, scale);\r\n        this.completedWordsContainer.setScale(scale, scale);\r\n        this.playWidget.setScale(scale, scale);\r\n        this.win.setScale(scale, scale);\r\n        this.constName.setScale(scale, scale);\r\n        this.sentences.setScale(scale, scale);\r\n        this.background.setScale(scale, scale);\r\n\r\n        if (!currentHorizontalState) {\r\n\r\n            this.background.setScale(scale * 2, scale * 2);\r\n            this.letterContainer.setScale(this.originalLetterContainerScale.x * 1.5 * scale, this.originalLetterContainerScale.y * 1.5* scale);\r\n            this.cardContainer.setScale(scale * 1.5, scale * 1.5);\r\n            this.completedWordsContainer.setScale(scale * 2, scale * 2);\r\n            this.sentences.setScale(scale * 1.3, scale * 1.3);\r\n\r\n        }\r\n\r\n        \r\n       \r\n\r\n       \r\n        console.log(`Screen resized: width=${width}, height=${height}, scale=${scale}`);\r\n    }\r\n    \r\n    \r\n    \r\n}\r\n\r\n\r\n\r\n\r\n"]}