{"version":3,"sources":["file:///D:/Cocos/CocosWordLineCreative/assets/scripts/wordConnect/WordConnectScreenScaler.ts"],"names":["_decorator","Component","Node","ResolutionPolicy","screen","Vec3","view","ccclass","property","WordConnectScreenScaler","type","originalWidth","originalHeigth","spellingVerticalOffset","originalRatio","horizontalState","originalDescriptionPosition","originalSpellingPosition","start","description","getPosition","spelling","onWindowResize","windowSize","width","height","onLoad","on","onDestroy","off","currentHorizontalState","setDesignResolutionSize","FIXED_WIDTH","setPosition","storeButton","parent","FIXED_HEIGHT","position","y","x","canvas","ratio","scale","setScale","redirectScreenInfo"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, ResolutionPolicy, screen, Vec3, view, Widget } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('WordConnectScreenScaler')\r\nexport class WordConnectScreenScaler extends Component {\r\n\r\n    @property({type:Node})\r\n    private canvas = null;\r\n\r\n    @property({type:Node})\r\n    private description = null;\r\n\r\n    @property({type:Node})\r\n    private spelling = null;\r\n\r\n    @property({type:Node})\r\n    private storeButton = null;\r\n\r\n    @property({type:Node})\r\n    private redirectScreen = null;\r\n\r\n    @property({type:Node})\r\n    private redirectScreenInfo = null;\r\n\r\n    private originalWidth: number = 1280;\r\n    private originalHeigth: number = 720;\r\n\r\n    private spellingVerticalOffset: number = 30;\r\n\r\n    private originalRatio: number = this.originalHeigth / this.originalWidth;\r\n    private horizontalState: boolean = true;\r\n    \r\n    private originalDescriptionPosition: Vec3;\r\n    private originalSpellingPosition: Vec3;\r\n\r\n    start() {\r\n        this.originalDescriptionPosition = this.description.getPosition();\r\n        this.originalSpellingPosition = this.spelling.getPosition();\r\n                \r\n        this.onWindowResize(screen.windowSize.width, screen.windowSize.height);\r\n    }\r\n\r\n    onLoad() {\r\n        screen.on('window-resize', this.onWindowResize, this);\r\n    }\r\n    \r\n    onDestroy() {\r\n        screen.off('window-resize', this.onWindowResize, this);\r\n    }\r\n\r\n    onWindowResize(width: number, height: number) {\r\n        const currentHorizontalState = width >= height;\r\n\r\n        if (currentHorizontalState != this.horizontalState) {\r\n            this.horizontalState = currentHorizontalState;\r\n\r\n            if (currentHorizontalState) {\r\n                view.setDesignResolutionSize(this.originalWidth, this.originalHeigth, ResolutionPolicy.FIXED_WIDTH);\r\n\r\n                this.description.setPosition(this.originalDescriptionPosition);\r\n                this.spelling.setPosition(this.originalSpellingPosition);\r\n                \r\n                this.storeButton.parent = this.description;\r\n            }\r\n            else {\r\n                view.setDesignResolutionSize(this.originalHeigth, this.originalWidth, ResolutionPolicy.FIXED_HEIGHT);\r\n\r\n                let position = new Vec3(this.originalDescriptionPosition.y, -this.originalDescriptionPosition.x);\r\n                this.description.setPosition(position);\r\n\r\n                position = new Vec3(this.originalSpellingPosition.y, this.spellingVerticalOffset - this.originalSpellingPosition.x);\r\n                this.spelling.setPosition(position);\r\n\r\n                this.storeButton.parent = this.canvas;\r\n            }\r\n        }\r\n\r\n        const ratio = currentHorizontalState ? height / width : width / height;\r\n        let scale = ratio / this.originalRatio;\r\n\r\n        if (scale > 1)\r\n            scale = 1;\r\n\r\n        this.description.setScale(scale, scale);\r\n        this.spelling.setScale(scale, scale);\r\n        this.redirectScreenInfo.setScale(scale, scale);\r\n\r\n        if (this.horizontalState) {\r\n            this.storeButton.setScale(1, 1);\r\n        }\r\n        else {\r\n            this.storeButton.setScale(scale, scale);\r\n        }\r\n    }   \r\n}\r\n"]}